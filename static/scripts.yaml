# https://tasmota.github.io/docs/Device-Recovery/#fast-power-cycle-device-recovery
tasmota_provide_reset_sequence:
  alias: "Tasmota: Provide reset sequence"
  description: "Provide the reset sequence for a Tasmota device"
  fields:
    device:
      description: "The Tasmota device to provide the reset sequence for"
      example: "switch.tasmota_device"
      required: true
  sequence:
    - repeat:
        count: 6
        sequence:
          - service: switch.turn_on
            target:
              entity_id: "{{ device }}"
          - delay: "00:00:01"
          - service: switch.turn_off
            target:
              entity_id: "{{ device }}"
          - delay: "00:00:01"
    - service: switch.turn_on
      target:
        entity_id: "{{ device }}"

toggle_enphase_charge_from_grid:
  mode: single
  alias: Toggle Enphase Charge from Grid
  fields:
    enabled:
      description: true to enable, false to disable
      example: true
  sequence:
    - service: rest_command.enphase_validate_cfg
      data:
        battery_id: 5886607
        user_id: 5185058
    - delay: "00:00:01"
    - service: rest_command.enphase_battery_charge_from_grid
      data:
        charge: "{{ enabled }}"
        battery_id: 5886607
        user_id: 5185058
